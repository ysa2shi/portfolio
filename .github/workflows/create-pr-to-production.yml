name: Create PR to production

permissions:
  contents: write

on:
  push:
    branches:
      - master

jobs:
  create-pr:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout master branch
        uses: actions/checkout@v3
        with:
          ref: master

      - name: Get current date in JST
        id: date
        run: |
          echo "date=$(TZ=Asia/Tokyo date '+%Y-%m-%d %H:%M:%S (JST)')" >> $GITHUB_OUTPUT

      - name: Create pull request to production
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          base: production
          branch: master
          title: 'Merge master into production - ${{ steps.date.outputs.date }}'
          body: |
            This pull request was automatically generated by GitHub Actions.

            **Created at (JST)**: ${{ steps.date.outputs.date }}
          draft: false
